{% extends "base.html" %}

{% block content %}
<div class="flex flex-col items-center text-center">
    
    {% if status == confirmed_status %}
        <!-- Pago Confirmado: Mostrar QR -->
        <div class="bg-green-500 text-white rounded-t-xl p-4 w-full">
            <h2 class="text-2xl font-bold">¡Pago Confirmado!</h2>
        </div>
        
        <div class="bg-white border-4 border-green-500 p-8 rounded-b-xl shadow-2xl mt-0">
            <p class="text-lg text-gray-700 mb-6">Tu código QR de Asistencia es válido.</p>
            
            {% if qr_base64 %}
                <div class="w-64 h-64 mx-auto mb-6">
                    <!-- El QR es un SVG incrustado directamente en Base64 para evitar guardar archivos -->
                    <img src="data:image/svg+xml;base64,{{ qr_base64 }}" alt="Código QR de Asistencia" class="w-full h-full object-contain p-2 bg-white rounded-lg shadow-lg" />
                </div>
            {% else %}
                <div class="text-red-500 text-lg">Error al generar la imagen QR.</div>
            {% endif %}

            <p class="text-sm text-gray-500">Muéstralo en el punto de registro.</p>
        </div>

    {% else %}
        <!-- Pago No Confirmado: Mostrar mensaje de estado -->
        <div class="bg-red-500 text-white rounded-t-xl p-4 w-full">
            <h2 class="text-2xl font-bold">QR No Disponible</h2>
        </div>
        
        <div class="bg-white border-4 border-red-500 p-8 rounded-b-xl shadow-2xl mt-0 space-y-4">
            <p class="text-lg font-semibold text-gray-800">Tu estado de pago actual es:</p>
            <p class="text-4xl font-extrabold text-red-600">{{ status }}</p>
            
            {% if status == 'Sin Pago Realizado' %}
                <p class="text-gray-700">Por favor, dirígete a la sección de pago para realizar la transferencia y registrarla.</p>
                <a href="{{ url_for('payment_info') }}" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 mt-4">
                    Ir a la Información de Pago
                </a>
            {% elif status == 'Pendiente de Revisión' %}
                <p class="text-gray-700">Tu comprobante de pago está en revisión. El QR se activará automáticamente al ser confirmado.</p>
                <a href="{{ url_for('profile') }}" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-indigo-600 bg-indigo-100 hover:bg-indigo-200 transition duration-150 mt-4">
                    Volver a Mi Perfil
                </a>
            {% else %}
                <p class="text-gray-700">Comunícate con soporte si crees que hay un error.</p>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}